{% load static %}

<!-- ================= メンバー検索モーダル ================= -->
<div id="searchMemberModal" class="fixed hidden inset-0 z-50">

  <!-- ===== モーダル背景 ===== -->
  <div class="modal-bg absolute inset-0 flex items-center justify-center bg-black/50 p-4">

    <!-- ===== モーダル本体 ===== -->
    <div class="modal-content relative flex h-[640px] w-full max-w-[500px] flex-col items-center rounded-lg bg-white p-10 text-xl shadow-xl">
      
      <!-- 閉じるボタン -->
      <button
        type="button"
        class="modal-close absolute top-4 right-4 text-gray-400 text-4xl hover:text-gray-600">
        ×
      </button>
      
      <!-- ===== 検索入力 ===== -->
      <div class="relative mb-8 w-full px-10">

        <!-- 検索アイコン -->
        <div class="pointer-events-none absolute inset-y-0 left-14 flex items-center">
          <svg class="h-6 w-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </div>

        <!-- HTMXでユーザー検索 -->
        <input
          type="text"
          name="q"
          placeholder="検索"
          class="w-full rounded-full border border-gray-400 py-3 pr-6 pl-14 text-xl focus:outline-none"
        {# hx-get="{% url 'user_search' %}" #}
          hx-trigger="keyup changed delay:500ms"
          hx-target="#search-results"
          hx-vals='{"team_id": "{{ selected_team.id }}"}'
        >
      </div>

      <!-- ===== 一覧全体 ===== -->
      <div class="w-full flex flex-col flex-grow overflow-hidden px-4">

        <!-- ===== ヘッダー ===== -->
        <table class="w-full table-fixed border-separate border-spacing-0">
          <thead>
            <tr class="bg-gray-100">
              <th class="w-[30%] py-2 pl-4 text-start font-bold text-teamy-navy">名前</th>
              <th class="w-[40%] py-2 text-start font-bold text-teamy-navy">ユーザーID</th>
              <th class="w-[30%] py-2 pr-4 text-end font-bold text-teamy-navy"></th>
            </tr>
          </thead>
        </table>

        <!-- ===== 検索結果 ===== -->
        <div id="search-results" class="w-full overflow-y-auto flex-grow">

          <table class="w-full table-fixed border-separate border-spacing-0">
            <tbody>

              {% for user in users %}
              <tr class="border-b border-gray-100 hover:bg-gray-50 transition-colors">
                <td class="w-[30%] py-4 pl-4 text-start text-gray-900">
                  {{ user.name }}
                </td>
                <td class="w-[40%] py-4 text-start text-gray-500">
                  {{ user.employee_id }}
                </td>
                <td class="w-[30%] py-4 pr-4 text-end">
                  <button
                    type="button"
                    class="bg-teamy-orange hover:bg-teamy-orangeDark text-white
                           px-3 py-1 rounded text-sm font-medium whitespace-nowrap
                           transition-all active:scale-95"
                    data-user-id="{{ user.id }}"
                    data-user-name="{{ user.name }}"
                  >
                    +追加
                  </button>
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="3" class="py-8 text-center text-gray-400">
                  ユーザーが見つかりません
                </td>
              </tr>
              {% endfor %}

            </tbody>
          </table>
        </div>
      </div>
      
    </div>
  </div>
</div>
